---
layout: post
title: 利用modbus协议实现主从设备通信（一）———— RS232,RS485,Modbus关系
discription: 
tags: linux
---
  废话不说了，这两天要用modbus协议实现主从设备的通信，之前对modbus协议，rs232，rs485不甚了解；所以专门拿出一天来去查阅相关资料以及详细阅读modbus协议

一、RS232与RS485
======
  从维基百科里参考的一些资料,做一下记录
###RS232
  在RS-232标准中，字符是以一串行的比特串来一个接一个的串行（serial）方式传输，优点是传输线少，配线简单，发送距离可以较远。最常用的编码格式是异步起停
  （asynchronous start-stop）格式，它使用一个起始比特后面紧跟7或8个数据比特（bit），然后是可选的奇偶校验比特，最后是一或两个停止比特。所以发送一个字
  符至少需要10比特，带来的一个好的效果是使全部的传输速率，发送信号的速率以10划分。一个最平常的代替异步起停方式的是使用高级数据链路控制协议（HDLC）。  

  在RS-232标准中定义了逻辑一和逻辑零电压级数，以及标准的传输速率和连接器类型。信号大小在正的和负的3－15v之间。RS-232规定接近零的电平是无效的，逻辑一
  规定为负电平，有效负电平的信号状态称为传号marking，它的功能意义为OFF，逻辑零规定为正电平，有效正电平的信号状态称为空号spacing，它的功能意义为ON。
  根据设备供电电源的不同，±5、±10、±12和±15这样的电平都是可能的。  
###RS485
  EIA-485（过去叫做RS-485 或者RS485）是隶属于OSI模型物理层的电气特性规定为2线，半双工，多点通信的标准。它的电气特性和RS-232大不一样。用缆线两端的
  电压差值来表示传递信号，1极的电压标识为逻辑1，另一段标识为逻辑0。两端的电压差最小为0.2V以上时有效，任何不大于12V或者不小于－7V的差值对接受端都被
  认为是正确的。  

  EIA-485仅仅规定了接受端和发送端的电气特性。它没有规定或推荐任何数据协议。EIA-485可以应用于配置便宜的广域网和采用单机发送，多机接受通信链接。它提供
  高速的数据通信速率（10 m 时35 Mbit/s ；1200 m时 100 kbit/s 1200 m）。EIA-485和EIA-422一样使用双绞线进行高电压差分平衡传输，它可以进行大面积长距离
  传输（超过4000英尺，1200米）。  

  和EIA-422相对照的是，EIA-422采用不可转换的单发送端，EIA-485的发送端需要设置为发送模式，这使得EIA-485可以使用双线模式实现真正的多点双向通信。

  EIA-485推荐使用在点对点网络中，线型、总线型，不能是星型、环型网络。理想情况下EIA-485需要2个终接电阻，其阻值要求等于传输电缆的特性阻抗。没有特性阻抗
  的话，当所有的设备都静止或者没有能量的时候就会产生噪声，而且线移需要双端的电压差。没有终接电阻的话，会使得较快速的发送端产生多个数据信号的边缘，
  这其中的一些是不正确的。之所以不能使用星型或者环型的拓扑结构是由于这些结构有不必要的反映，过低或者过高的终接电阻可以产生电磁干扰。  

  EIA-485在使用四线时可以和EIA-422一样实现全双工。EIA-485可以实现真正的多点通信，在许多情况下并没有什么用处。在某些限制条件下，EIA-485和EIA-422可以
  实现相互的连接。  
###RS232与RS485区别（）  
  这篇博客总结的很好!我就不班门弄斧啦，
  <http://blog.csdn.net/kevinhg/article/details/7367144>  

####实际上RS232与RS485都是属于物理层设备，都规定了相应的电气特性。

二、modbus协议
=====
  modbus协议定义了OSI的第七层应用层上的报文传输协议，进行主从交换Modbus请求.

> 层 ISO/OSI  模型   
> 7  应用层   Modbus 协议  
> 6  表示层   空  
> 5  会话层   空  
> 4  传输层   空  
> 3  网络层   空  
> 2  数据链路层 Modbus 串行链路协议  
> 1  物理层   EIA/TIA-485 (或 EIA/TIA-232)  

  这样我们就显而易见了,这里RS485,RS232都在物理层,也就是我所用的串口通信的硬件单元,只要配置好波特率,数据位,停止位,奇偶校验就好了,物理层已经不需要我们关心了.  
  
  接下来是Modbus协议了,MODBUS 协议定义了一个与基础通信层无关的简单协议数据单元(PDU)特定总线或网络上的 MODBUS 协议映射能够在应用数据单元(ADU)上引入一些附加域.  
  应用数据单元:ADU = 地址域+PDU+差错校验  
  简单数据单元:PDU = 功能码+数据  

  最后是Modbus串行链路协议啦,这才是我们需要做的.由于第一天我没有理清他们三者之间的关系,让我头疼了一上午,  
  
###下一篇将着重分析一下modbus串行链路协议
  
  
































